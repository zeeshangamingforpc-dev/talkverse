// Load voices in dropdown
function loadVoices() {
    const voiceSelect = document.getElementById("voice-select");
    const voices = speechSynthesis.getVoices();

    if (!voices.length) {
        // Retry when voices are still loading
        setTimeout(loadVoices, 100);
        return;
    }

    voiceSelect.innerHTML = "";
    voices.forEach((voice, index) => {
        let option = document.createElement("option");
        option.value = index;
        option.textContent = `${voice.name} (${voice.lang})`;
        voiceSelect.appendChild(option);
    });
}

// Speak Function
function speakText() {
    const text = document.getElementById("text-input").value;
    const voiceSelect = document.getElementById("voice-select");
    const speed = document.getElementById("speed").value;
    const pitch = document.getElementById("pitch").value;

    if (!text.trim()) {
        alert("Please enter text first!");
        return;
    }

    const utterance = new SpeechSynthesisUtterance(text);
    const voices = speechSynthesis.getVoices();

    if (voices.length > 0) {
        utterance.voice = voices[voiceSelect.value];
    }

    utterance.rate = speed;
    utterance.pitch = pitch;

    speechSynthesis.speak(utterance);
}

// Voices Load Event
speechSynthesis.onvoiceschanged = loadVoices;

// First load call
loadVoices();
