const textArea = document.getElementById('text');
const voiceSelect = document.getElementById('voiceSelect');
const generateBtn = document.getElementById('generateVoiceBtn');
const downloadBtn = document.getElementById('downloadBtn');
const speed = document.getElementById('speed');
const pitch = document.getElementById('pitch');

let voices = [];

function populateVoiceList() {
    voices = speechSynthesis.getVoices();
    voiceSelect.innerHTML = '';
    voices.forEach(v => {
        const option = document.createElement('option');
        option.textContent = `${v.name} (${v.lang})`;
        option.value = v.name;
        voiceSelect.appendChild(option);
    });
}

populateVoiceList();
if (speechSynthesis.onvoiceschanged !== undefined) {
    speechSynthesis.onvoiceschanged = populateVoiceList;
}

// Generate Voice
generateBtn.addEventListener('click', () => {
    const text = textArea.value.trim();
    if(!text){ alert("Please type some text!"); return; }

    const utterance = new SpeechSynthesisUtterance(text);
    const selectedVoice = voices.find(v => v.name === voiceSelect.value);
    if(selectedVoice) utterance.voice = selectedVoice;

    utterance.rate = parseFloat(speed.value);
    utterance.pitch = parseFloat(pitch.value);

    speechSynthesis.speak(utterance);
});

// Download MP3 (placeholder)
downloadBtn.addEventListener('click', () => {
    alert("To enable MP3 download, integrate a free TTS API like ElevenLabs or TTSMP3.");
});
const text = document.getElementById('text').value.trim();
if(!text){ alert("Type some text first!"); return; }

fetch("https://api.elevenlabs.io/v1/text-to-speech/YOUR_VOICE_ID", {
    method: "POST",
    headers: {
        "Accept": "audio/mpeg",
        "Content-Type": "application/json",
        "xi-api-key": "YOUR_API_KEY"
    },
    body: JSON.stringify({
        text: text,
        voice: "alloy"  // example voice, API dependent
    })
})
.then(res => res.blob())
.then(blob => {
    // Create a download link
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = "tts.mp3";
    a.click();
})
.catch(err => console.error("Error generating MP3:", err));

<button id="downloadBtn">Download MP3</button>
